<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-07-06 Wed 11:46 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CoupledCluster</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>

    <meta charset='UTF-8'>
    <meta name='apple-mobile-web-app-capable' content='yes'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.slim.min.js"
      integrity="sha512-6ORWJX/LrnSjBzwefdNUyLCMTIsGoNP6NftMy2UAm1JBm6PRZCO1d7OHBStWpVFZLO+RerTvqX/Z9mBFfCJZ4A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"></script>
    <link
      href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css'
      rel='stylesheet'
      integrity='sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU'
      crossorigin='anonymous'>
    <script
      src='https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js'
      integrity='sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ'
      crossorigin='anonymous'></script>

    <link rel="stylesheet" type="text/css" href="/user-manual/data/css/htmlize.css"/>
    <link rel="stylesheet" type="text/css" href="/user-manual/data/css/readtheorg.css"/>
    <link rel="stylesheet" type="text/css" href="/user-manual/data/css/rtd-full.css"/>

    <script type="text/javascript" src="/user-manual/data/js/readtheorg.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="preamble" class="status">

 <nav id="cc4s-navbar" class='navbar fixed-top navbar-expand-md navbar-light bg-light'>
   <div class='container-fluid'>
     <a class='navbar-brand' href='#'>
       Cc4s
     </a>
     <button class='navbar-toggler' type='button'
             data-bs-toggle='collapse'
             data-bs-target='#navbarSupportedContent'
             aria-controls='navbarSupportedContent'
             aria-expanded='false'
             aria-label='Toggle navigation'>
       <span class='navbar-toggler-icon'></span>
     </button>
     <div class='collapse navbar-collapse' id='navbarSupportedContent'>
       <ul class='navbar-nav me-auto mb-2 mb-lg-0'>
         <li class='nav-item'>
           <a class='nav-link' aria-current='page' href='/user-manual/index.html'>
             <i class='fa fa-home'></i>
             Home
           </a>
         </li>
         <li class='nav-item'>
           <a class='nav-link' href='/user-manual/sitemap.html'>
             <i class='fa fa-sign-out'></i>
             Sitemap
           </a>
         </li>
         <li class='nav-item'>
           <a class='nav-link' href='/user-manual/algorithms/sitemap.html'>
             <i class='fa fa-sign-out'></i>
             Algorithms
           </a>
         </li>
         <li class='nav-item'>
           <a class='nav-link' href='/user-manual/objects/sitemap.html'>
             <i class='fa fa-sign-out'></i>
             Objects
           </a>
         </li>
       </ul>
     </div>
   </div>
 </nav>
</div>
<div id="content" class="content">
<h1 class="title">CoupledCluster</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org851edda">1. Brief description</a></li>
<li><a href="#org70c27ad">2. Algorithm call</a></li>
<li><a href="#org090aece">3. Algorithm input</a>
<ul>
<li><a href="#method">3.1. method</a></li>
<li><a href="#linearized">3.2. linearzied</a></li>
<li><a href="#integralsslicesize">3.3. integralsSliceSize</a></li>
<li><a href="#maxiterations">3.4. maxIterations</a></li>
<li><a href="#energyconvergence">3.5. energyConvergence</a></li>
<li><a href="#amplitudesconvergence">3.6. amplitudesConvergence</a></li>
<li><a href="#initialAmplitude">3.7. initialAmplitudes</a></li>
<li><a href="#mixer">3.8. mixer</a>
<ul>
<li><a href="#org4be56ed">3.8.1. DiisMixer</a></li>
<li><a href="#org09f438c">3.8.2. LinearMixer</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org70a2357">4. Algorithm output</a>
<ul>
<li><a href="#org6c3091c">4.1. Sample <code>stdout</code></a></li>
</ul>
</li>
<li><a href="#org4d3b18a">5. Sample <code>yaml</code> output</a></li>
<li><a href="#org4dd3676">6. Computational complexity</a></li>
<li><a href="#org91c77a4">7. Theory</a>
<ul>
<li><a href="#org04f6c82">7.1. Coupled-Cluster Singles Doubles (<code>Ccsd</code>)</a></li>
<li><a href="#org9db9278">7.2. Direct-Ring Couple-Cluster Doubles (<code>Drccd</code>)</a></li>
</ul>
</li>
<li><a href="#org49d038b">8. Literature</a></li>
</ul>
</div>
</div>

<div id="outline-container-org851edda" class="outline-2">
<h2 id="org851edda"><span class="section-number-2">1.</span> <a href="#org851edda">Brief description</a></h2>
<div class="outline-text-2" id="text-1">
<p>
This algorithm solves the CCSD amplitude equations using the Coulomb integrals
and Hartree&#x2013;Fock eigenenergies.
</p>
</div>
</div>

<div id="outline-container-org70c27ad" class="outline-2">
<h2 id="org70c27ad"><span class="section-number-2">2.</span> <a href="#org70c27ad">Algorithm call</a></h2>
<div class="outline-text-2" id="text-2">
<p>
A typical input file snippet to call the <code>CoupledCluster</code> algorithm is given below.
</p>
<div class="org-src-container">
<pre class="src src-yaml">- <span style="color: #8b4513;">name</span>: CoupledCluster
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">method</span>: Ccsd
    <span style="color: #8b4513;">integralsSliceSize</span>: 100
    <span style="color: #8b4513;">slicedEigenEnergies</span>: EigenEnergies
    <span style="color: #8b4513;">coulombIntegrals</span>: CoulombIntegrals
    <span style="color: #8b4513;">slicedCoulombVertex</span>: CoulombVertex
    <span style="color: #8b4513;">maxIterations</span>: 20
    <span style="color: #8b4513;">energyConvergence</span>: 1.0E-4
    <span style="color: #8b4513;">amplitudesConvergence</span>: 1.0E-4
    <span style="color: #8b4513;">mixer</span>:
      <span style="color: #8b4513;">type</span>: DiisMixer
      <span style="color: #8b4513;">maxResidua</span>: 5
    <span style="color: #a0a1a7; font-weight: bold;">#</span><span style="color: #a0a1a7;">or for instance a linear mixer</span>
    <span style="color: #a0a1a7; font-weight: bold;">#</span><span style="color: #a0a1a7;">mixer:</span>
    <span style="color: #a0a1a7; font-weight: bold;">#  </span><span style="color: #a0a1a7;">type: LinearMixer</span>
    <span style="color: #a0a1a7; font-weight: bold;">#  </span><span style="color: #a0a1a7;">ratio: 1.0</span>
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">amplitudes</span>: Amplitudes
</pre>
</div>
</div>
</div>

<div id="outline-container-org090aece" class="outline-2">
<h2 id="org090aece"><span class="section-number-2">3.</span> <a href="#org090aece">Algorithm input</a></h2>
<div class="outline-text-2" id="text-3">
<table id="org8690b7e" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Input keywords</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Keyword</th>
<th scope="col" class="org-left">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>method</code></td>
<td class="org-left"><a href="#method">Type of coupled cluster algorithm</a></td>
</tr>

<tr>
<td class="org-left"><code>linearized</code></td>
<td class="org-left"><a href="#linearized">Use linearized or fully non-linear coupled cluster</a></td>
</tr>

<tr>
<td class="org-left"><code>integralsSliceSize</code></td>
<td class="org-left"><a href="#integralsslicesize">Integral slice size</a></td>
</tr>

<tr>
<td class="org-left"><code>slicedEigenEnergies</code></td>
<td class="org-left"><a href="../objects/SlicedEigenEnergies.html#ID-SlicedEigenEnergies">Sliced one-electron energies</a></td>
</tr>

<tr>
<td class="org-left"><code>coulombIntegrals</code></td>
<td class="org-left"><a href="../objects/CoulombIntegrals.html#ID-CoulombIntegrals">Coulomb Integrals</a></td>
</tr>

<tr>
<td class="org-left"><code>slicedCoulombVertex</code></td>
<td class="org-left"><a href="../objects/SlicedCoulombVertex.html#ID-SlicedCoulombVertex">Sliced Coulomb vertex</a></td>
</tr>

<tr>
<td class="org-left"><code>maxIterations</code></td>
<td class="org-left"><a href="#maxiterations">Maximum number of iterations</a></td>
</tr>

<tr>
<td class="org-left"><code>energyConvergence</code></td>
<td class="org-left"><a href="#energyconvergence">Energy convergence threshold</a></td>
</tr>

<tr>
<td class="org-left"><code>amplitudesConvergence</code></td>
<td class="org-left"><a href="#amplitudesconvergence">Amplitude convergence threshold</a></td>
</tr>

<tr>
<td class="org-left"><code>mixer</code></td>
<td class="org-left"><a href="#mixer">Mixer type and parameters</a></td>
</tr>

<tr>
<td class="org-left"><code>initialAmplitudes</code></td>
<td class="org-left"><a href="../objects/Amplitudes.html#ID-Amplitudes">initial Amplitudes to begin the iterations</a></td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-method" class="outline-3">
<h3 id="method"><span class="section-number-3">3.1.</span> <a href="#method">method</a></h3>
<div class="outline-text-3" id="text-method">
<p>
<code>method</code> specifies which approximation of the coupled-cluster
<a href="../objects/Amplitudes.html#ID-Amplitudes"><code>Amplitudes</code></a> should be used. See the
<a href="../objects/Amplitudes.html#ID-Amplitudes"><code>Amplitudes</code></a> for the specification of
each approximation.
The currently available approximations are:
</p>
<dl class="org-dl">
<dt><code>Ccsd</code></dt><dd>Coupled Cluster singles and doubles. See (<a href="#citeproc_bib_item_1">Bartlett and Musiał 2007</a>) and references therin.</dd>
<dt><code>CcsdReference</code></dt><dd>Canonical and unoptimized version of the <code>Ccsd</code> algorithm.
This algorithm has the same inputs as <code>Ccsd</code> with the exception that the
arguments
<a href="#integralsslicesize">integralSliceSize</a> and
<a href="../objects/SlicedCoulombVertex.html#ID-SlicedCoulombVertex">slicedCoulombVertex</a> and
are ignored.</dd>
<dt><code>Drccd</code></dt><dd>Unoptimized implementation of Direct-Ring Coupled Cluster
singles and doubles giving the Random Phase Approximation (RPA)
with the Second Order Screened Exchange (SOSEX) correction
(<a href="#citeproc_bib_item_4">Freeman 1977</a>; <a href="#citeproc_bib_item_7">Grüneis et al. 2009</a>).</dd>
</dl>
</div>
</div>

<div id="outline-container-linearized" class="outline-3">
<h3 id="linearized"><span class="section-number-3">3.2.</span> <a href="#linearized">linearzied</a></h3>
<div class="outline-text-3" id="text-linearized">
<p>
<code>linearized</code> A non-zero value indicates that the linearized
coupled-cluster amplitude equations should be solved, rather
than the fully non-linear ones.
The default is <code>linearized: 0</code>.
Note: currently only <code>method: Drccd</code> supports linearized
amplitude equations.
</p>
</div>
</div>

<div id="outline-container-integralsslicesize" class="outline-3">
<h3 id="integralsslicesize"><span class="section-number-3">3.3.</span> <a href="#integralsslicesize">integralsSliceSize</a></h3>
<div class="outline-text-3" id="text-integralsslicesize">
<p>
<code>integralsSliceSize</code> controls the slice size of the \(V_{cd}^{ab}\) integrals, which are computed on-the-fly to
reduce the memory footprint. The integer value specified for <code>integralsSliceSize</code>  refers to the dimension size
used for the \(a\) and \(b\) index. We recommend setting <code>integralsSliceSize: 100</code> to balance
computational efficency with memory usage. Smaller/larger values reduce/increase the memory footprint.
</p>
</div>
</div>

<div id="outline-container-maxiterations" class="outline-3">
<h3 id="maxiterations"><span class="section-number-3">3.4.</span> <a href="#maxiterations">maxIterations</a></h3>
<div class="outline-text-3" id="text-maxiterations">
<p>
<code>maxIterations</code> controls the maximum number of iterations allowed to solve the  \(t_{ij}^{ab}\) and \(t_i^a\) amplitude equations.
If convergence of the energy and residual vectors within the specified thresholds is achieved using fewer iterations
than <code>maxIterations</code>, the algorithm was successfull and will stop.
If <code>maxIterations</code> is reached without achieving <code>energyConvergence</code> and <code>amplitudesConvergence</code> , the algorithm was not
successful and will stop. We recommend to set <code>maxIterations: 20</code>, which is ususally enough to achieve reasonable convergence
thresholds.
</p>
</div>
</div>

<div id="outline-container-energyconvergence" class="outline-3">
<h3 id="energyconvergence"><span class="section-number-3">3.5.</span> <a href="#energyconvergence">energyConvergence</a></h3>
<div class="outline-text-3" id="text-energyconvergence">
<p>
<code>energyConvergence</code> specifies the convergence threshold for the correlation energy.
If <code>energyConvergence</code> and <code>amplitudesConvergence</code> is achieved, the iterative solution was successful and the algorithm will stop.
</p>
</div>
</div>

<div id="outline-container-amplitudesconvergence" class="outline-3">
<h3 id="amplitudesconvergence"><span class="section-number-3">3.6.</span> <a href="#amplitudesconvergence">amplitudesConvergence</a></h3>
<div class="outline-text-3" id="text-amplitudesconvergence">
<p>
<code>amplitudesConvergence</code> specifies the convergence threshold for the residual vector of the singles and doubles amplitude equations.
If <code>energyConvergence</code> and <code>amplitudesConvergence</code> is achieved, the iterative solution was successful and the algorithm will stop.
</p>
</div>
</div>

<div id="outline-container-initialAmplitude" class="outline-3">
<h3 id="initialAmplitude"><span class="section-number-3">3.7.</span> <a href="#initialAmplitude">initialAmplitudes</a></h3>
<div class="outline-text-3" id="text-initialAmplitude">
<p>
<code>initialAmplitudes</code> specifies amplitudes from a precedent calculations. This allows restarting a self consistent calculation from a former checkpoint.
</p>
</div>
</div>



<div id="outline-container-mixer" class="outline-3">
<h3 id="mixer"><span class="section-number-3">3.8.</span> <a href="#mixer">mixer</a></h3>
<div class="outline-text-3" id="text-mixer">
<p>
<code>mixer</code> specifies mixer-specific parameters used to solve the amplitude equations iteratively.
The direct inversion iterative subspace (Diis) algorithm is the default algorithm used to mix amplitude guesses from previous
iterations to improve the guess for the next iteration.
<code>mixer: type</code> can currently be set to <code>*DiisMixer</code> or <code>*LinearMixer</code>.
</p>
</div>

<div id="outline-container-org4be56ed" class="outline-4">
<h4 id="org4be56ed"><span class="section-number-4">3.8.1.</span> <a href="#org4be56ed">DiisMixer</a></h4>
<div class="outline-text-4" id="text-3-8-1">
<p>
For <code>mixer: type: DissMixer</code>, it is possible to specify <code>mixer: maxResidua</code>, which controls the number of residual
vectors used by the Diis mixer.
We recommend to set the maximum number of residual vectors used in the <code>DiisMixer</code> to <code>5</code>.
More residual vectors result in a larger memory footprint.
</p>

<dl class="org-dl">
<dt>Example</dt><dd></dd>
</dl>
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #8b4513;">mixer</span>:
  <span style="color: #8b4513;">type</span>: DiisMixer
  <span style="color: #8b4513;">maxResidua</span>: 5
</pre>
</div>
</div>
</div>


<div id="outline-container-org09f438c" class="outline-4">
<h4 id="org09f438c"><span class="section-number-4">3.8.2.</span> <a href="#org09f438c">LinearMixer</a></h4>
<div class="outline-text-4" id="text-3-8-2">
<p>
For <code>mixer: type: LinearMixer</code> it is possible to specify <code>mixer: ratio</code>, which controls the mixing ratio used
to update the new guess of the amplitudes based on estimates from the previous and current iteration.
The <code>LinearMixer</code> exhibits the smallest possible memory footprint from all currently available mixers,
keeping two sets of amplitudes in memory at once only.
We recommend to set <code>mixer: ratio: 1.0</code>. Smaller ratios result in a slower but perhaps more stable convergence.
</p>

<dl class="org-dl">
<dt>Example</dt><dd></dd>
</dl>
<div class="org-src-container">
<pre class="src src-yaml" id="org1269e84"><span style="color: #8b4513;">mixer</span>:
  <span style="color: #8b4513;">type</span>: LinearMixer
  <span style="color: #8b4513;">ratio</span>: 1.0
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org70a2357" class="outline-2">
<h2 id="org70a2357"><span class="section-number-2">4.</span> <a href="#org70a2357">Algorithm output</a></h2>
<div class="outline-text-2" id="text-4">
<table id="org8769604" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> Output keywords for CoupledCluster</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Keyword</th>
<th scope="col" class="org-left">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>amplitudes</code></td>
<td class="org-left"><a href="../objects/Amplitudes.html#ID-Amplitudes">Amplitudes</a></td>
</tr>
</tbody>
</table>

<p>
The output of the <b>CoupledCluster</b> algorithm includes <code>energy</code> and <code>amplitudes</code> . The <code>amplitudes</code> output contains
the converged singles and doubles amplitude tensors. The amplitudes can be used as input for algorithms
that estimate the finite simulation cell size error (<b>FiniteSizeCorrection</b>)
and the basis set incompleteness errors (<b>BasisSetCorrection</b>).
</p>
</div>

<div id="outline-container-org6c3091c" class="outline-3">
<h3 id="org6c3091c"><span class="section-number-3">4.1.</span> <a href="#org6c3091c">Sample <code>stdout</code></a></h3>
<div class="outline-text-3" id="text-4-1">
<p>
Below an example standard output stream is shown for a successful <b>CoupledCluster</b> algorithm run.
</p>
<div class="org-src-container">
<pre class="src src-sh">step: 6, CoupledCluster
Using method Ccsd. integralsSliceSize: 100
Using mixer DiisMixer. maxResidua: 5
Maximum number of iterations: 30
Unless reaching energy convergence dE: 1e-05
and amplitudes convergence dR: 1e-05
Iter         Energy         dE           dR         time   GF/s/core
   1  -2.43605043e+01  -2.4361e+01   4.3924e-01      0.5    1.0
   2  -2.47577534e+01  -3.9725e-01   7.4733e-02      0.8    4.8
   3  -2.53776918e+01  -6.1994e-01   1.8674e-02      0.7    5.4
   4  -2.54455925e+01  -6.7901e-02   6.4132e-03      0.7    5.5
   5  -2.54445080e+01   1.0845e-03   2.2120e-03      0.7    5.4
   6  -2.54458312e+01  -1.3232e-03   1.0304e-03      0.7    5.4
   7  -2.54448941e+01   9.3705e-04   5.0727e-04      0.7    5.4
   8  -2.54452894e+01  -3.9521e-04   1.9694e-04      0.7    5.4
   9  -2.54454262e+01  -1.3682e-04   7.7180e-05      0.7    5.4
  10  -2.54455328e+01  -1.0663e-04   3.0247e-05      0.7    5.4
  11  -2.54455929e+01  -6.0110e-05   1.1758e-05      0.7    5.4
  12  -2.54456151e+01  -2.2218e-05   5.0053e-06      0.7    5.4
  13  -2.54456249e+01  -9.7454e-06   2.2689e-06      0.7    5.4

Ccsd correlation energy:          -25.4456248862
2nd-order correlation energy:     -24.3605043096
realtime 9.189542891 s
--
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4d3b18a" class="outline-2">
<h2 id="org4d3b18a"><span class="section-number-2">5.</span> <a href="#org4d3b18a">Sample <code>yaml</code> output</a></h2>
<div class="outline-text-2" id="text-5">
<p>
Below an example <code>yaml</code> output stream is shown for a successful <b>CoupledCluster</b> algorithm run.
</p>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #8b4513;">name</span>: CoupledCluster
<span style="color: #8b4513;">out</span>:
  <span style="color: #8b4513;">amplitudes</span>: 0x26e4758
  <span style="color: #8b4513;">convergenceReached</span>: 1
  <span style="color: #8b4513;">energy</span>:
    <span style="color: #8b4513;">correlation</span>: -25.445624886202758
    <span style="color: #8b4513;">direct</span>: -38.822491455744313
    <span style="color: #8b4513;">exchange</span>: 13.376866569541555
    <span style="color: #8b4513;">secondOrder</span>: -24.360504309639897
    <span style="color: #8b4513;">unit</span>: 0.036749322175638782
<span style="color: #8b4513;">realtime</span>: 9.189542891
</pre>
</div>
</div>
</div>



<div id="outline-container-org4dd3676" class="outline-2">
<h2 id="org4dd3676"><span class="section-number-2">6.</span> <a href="#org4dd3676">Computational complexity</a></h2>
<div class="outline-text-2" id="text-6">
<p>
This section explains computational or memory footprints
for the various methods implemented in <b>CoupledCluster</b>
<a href="#method">(see method)</a>.
</p>

<dl class="org-dl">
<dt><code>Ccsd</code></dt><dd><p>
The computational bottle neck of a typical Ccsd calculation originates
from the following contraction, which is
part of the doubles amplitude equations: \(V_{cd}^{ab} t_{ij}^{cd}\).
The computational cost for evaluating this expression scales
as \(\mathcal{O}(N_{\rm o}^2 N_{\rm v}^4)\). To avoid a memory
footprint of \(\mathcal{O}(N_{\rm v}^4)\) in storing
\(V_{cd}^{ab}\), slices \(V_{cd}^{xy}\) are computed on-the-fly and used
in the contraction, reducing the corresponding memory footprint to
\(\mathcal{O}(N_{\rm v}^2 N_{\rm s}^2)\),
where \(N_{\rm s}\) is controlled using
the <code>integralsSliceSize</code> keyword.
</p>

<p>
We note that required storage of a set of doubles amplitudes adds
substantially to the memory footprint in Ccsd calculations.
The Diis algorithm requires the storage of both doubles residua and amplitudes
<code>maxResidua</code> times. We recommend to choose the
type of mixer and its parameters carefully to reduce the memory
footprint if necessary.
</p></dd>

<dt><code>Drccd</code></dt><dd>The computational complexity is \(\mathcal O(N_\mathrm{o}^3N_\mathrm{v}^3)\).
The implementation is not optimized for large systems. The memory requirement
scales as \(\mathcal O(N_\mathrm{o}^2 N_\mathrm{v}^2)\)</dd>
</dl>
</div>
</div>

<div id="outline-container-org91c77a4" class="outline-2">
<h2 id="org91c77a4"><span class="section-number-2">7.</span> <a href="#org91c77a4">Theory</a></h2>
<div class="outline-text-2" id="text-7">
<p>
Coupled-cluster employs the exponential Ansatz for the correlated wave function
</p>
\begin{equation}
  | \Psi \rangle = e^{\hat T} | \Phi \rangle,
\end{equation}
<p>
where \(|\Phi\rangle\) denotes the single Hartree&#x2013;Fock slater determinant.
The cluster operator \(\hat T = \hat T_1 + \hat T_2 + \ldots\) is
expanded in increasing number of excitation levels. The single and
double exciation parts of the cluster operator are given by
</p>
\begin{eqnarray}
  \hat T_1 = \sum_{ai} t^a_i \hat\tau^a_i, \\
  \hat T_2 = \sum_{abij} t^{ab}_{ij} \hat\tau^{ab}_{ij},
\end{eqnarray}
<p>
where \(\hat \tau^{a\ldots}_{i\ldots} = \hat c^\dagger_a\ldots \hat c_i\ldots\)
denotes the exciation operator.
The coefficients \(t^a_i\), \(t^{ab}_{ij}\), \(\ldots\) are called coupled-cluster
<code>Amplitudes</code>.
They are found by projecting the stationary Schrödinger equation for the
coupled-cluster Ansatz \(E|\Psi\rangle = \hat H|\Psi\rangle\)
on \(\langle \Phi|e^{-\hat T}\).
The resulting over-determined set of equations is truncated at the
same level as the cluster-operator \(\hat T\), giving as many equations
as there are coefficients in \(\hat T\).
The <code>Amplitudes</code> are generated by the <a href="CoupledCluster.html#ID-CoupledCluster"><code>CoupledCluster</code></a>
algorithm by solving the amplitude equation of the employed
coupled-cluster method, described below:
</p>
</div>

<div id="outline-container-org04f6c82" class="outline-3">
<h3 id="org04f6c82"><span class="section-number-3">7.1.</span> <a href="#org04f6c82">Coupled-Cluster Singles Doubles (<code>Ccsd</code>)</a></h3>
<div class="outline-text-3" id="text-7-1">
<p>
The cluster-operator is truncated containing only single and double
excitations. The projections on the singly and doubly excited
slater-determinants \(\langle \Phi^a_i|\) and \(\langle \Phi^{ab}_{ij}|\) give
</p>
\begin{align}
  \big\langle \Phi^{a}_{i} \big| e^{-\hat T} \hat H e^{\hat T}
    \big| \Phi \big\rangle &= 0 \quad \forall ai, \\
  \label{eqn:t2}
  \big\langle \Phi^{ab}_{ij} \big| e^{-\hat T} \hat H e^{\hat T}
    \big| \Phi \big\rangle &= 0 \quad \forall abij.
\end{align}
<p>
The above equations expand to a finite set of a few dozens of, in general,
non-linear algebraic contractions of \(t^a_i\) and \(t^{ab}_{ij}\) with
\(\varepsilon_p\) and \(V^{pq}_{sr}\). See (<a href="#citeproc_bib_item_10">Shavitt and Bartlett 2009</a>) for
a text-book introduction of the original works of
(<a href="#citeproc_bib_item_3">Coester and Kümmel 1960</a>) and (<a href="#citeproc_bib_item_11">Čížek 1969</a>).
</p>
</div>
</div>

<div id="outline-container-org9db9278" class="outline-3">
<h3 id="org9db9278"><span class="section-number-3">7.2.</span> <a href="#org9db9278">Direct-Ring Couple-Cluster Doubles (<code>Drccd</code>)</a></h3>
<div class="outline-text-3" id="text-7-2">
<p>
This method uses only the double
excitation part of the cluster-operator. From
the full doubles amplitude equations in Eq. (\ref{eqn:t2}) only
those contractions are considered where pairs of particle and hole
contractions originate from a common vertex and terminate in another
common vertex,
forming direct-rings in the diagrammatic notation.
Only five terms remain in a canonical calculation and they read
</p>
\begin{equation}
  \Delta^{ab}_{ij} t^{ab}_{ij}
  + V^{ab}_{ij}
  + V^{kb}_{cj} t^{ac}_{ik}
  + V^{al}_{id} t^{db}_{lj}
  + V^{kl}_{cd} t^{ac}_{ik} t^{db}_{lj} = 0 \quad \forall abij,
\end{equation}
<p>
with
\(\Delta^{ab}_{ij} = \varepsilon_a+\varepsilon_b-\varepsilon_i-\varepsilon_j\)
and where a sum over all indices that occurr only on the left-hand-side
is implied. These terms are the dominant terms of coupled-cluster singles
doubles in the hight-density limit (<a href="#citeproc_bib_item_6">Gell-Mann and Brueckner 1957</a>).
The direct correlation contribution of the <code>Drccd</code> method
\(\sum_{abij} 2t^{ab}_{ij}V^{ij}_{ab}\) gives the Random Phase Approximation (RPA),
the remaining exchange contribution is often termed Second Order
Screened Exchange (SOSEX) correction
(<a href="#citeproc_bib_item_4">Freeman 1977</a>; <a href="#citeproc_bib_item_7">Grüneis et al. 2009</a>).
See (<a href="#citeproc_bib_item_5">Furche 2008</a>; <a href="#citeproc_bib_item_2">Chen, Agee, and Furche 2018</a>) for a review on the RPA and its corrections,
as well as (<a href="#citeproc_bib_item_8">Macke 1950</a>; <a href="#citeproc_bib_item_9">Pines and Bohm 1952</a>) for the
original work on the RPA.
</p>

<p>
We recommend the following review article and references therein to get started with coupled-cluster theory (<a href="#citeproc_bib_item_1">Bartlett and Musiał 2007</a>) .
</p>
</div>
</div>
</div>

<div id="outline-container-org49d038b" class="outline-2">
<h2 id="org49d038b"><span class="section-number-2">8.</span> <a href="#org49d038b">Literature</a></h2>
<div class="outline-text-2" id="text-8">
<style>.csl-entry{text-indent: -1.5em; margin-left: 1.5em;}</style><div class="csl-bib-body">
  <div class="csl-entry"><a id="citeproc_bib_item_1"></a>Bartlett, R.J., and Monika Musiał. 2007. “Coupled-cluster theory in quantum chemistry.” <i>Rev. Mod. Phys.</i> 79 (1): 291–352. doi:<a href="https://doi.org/10.1103/RevModPhys.79.291">10.1103/RevModPhys.79.291</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_2"></a>Chen, Guo P., Matthew M. Agee, and Filipp Furche. 2018. “Performance and Scope of Perturbative Corrections to Random-Phase Approximation Energies.” <i>J. Chem. Theory Comput.</i> 14: 5701–14. doi:<a href="https://doi.org/10.1021/acs.jctc.8b00777">10.1021/acs.jctc.8b00777</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_3"></a>Coester, F., and H. Kümmel. 1960. “Short-Range Correlations in Nuclear Wave Functions.” <i>Nucl. Phys.</i> 17 (June): 477–85. doi:<a href="https://doi.org/10.1016/0029-5582(60)90140-1">10.1016/0029-5582(60)90140-1</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_4"></a>Freeman, David. 1977. “Coupled-Cluster Expansion Applied to the Electron Gas: Inclusion of Ring and Exchange Effects.” <i>Physical Review B</i> 15 (12): 5512–21. doi:<a href="https://doi.org/10.1103/PhysRevB.15.5512">10.1103/PhysRevB.15.5512</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_5"></a>Furche, Filipp. 2008. “Developing the Random Phase Approximation into a Practical Post-Kohnsham Correlation Model.” <i>J. Chem. Phys.</i> 129: 114105. doi:<a href="https://doi.org/10.1063/1.2977789">10.1063/1.2977789</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_6"></a>Gell-Mann, Murray, and Keith A. Brueckner. 1957. “Correlation Energy of an Electron Gas at High Density.” <i>Phys. Rev.</i> 106 (2): 364–68. doi:<a href="https://doi.org/10.1103/PhysRev.106.364">10.1103/PhysRev.106.364</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_7"></a>Grüneis, Andreas, Martijn Marsman, Judith Harl, Laurids Schimka, and Georg Kresse. 2009. “Making the Random Phase Approximation to Electronic Correlation Accurate.” <i>J. Chem. Phys.</i> 131 (15): 154115. doi:<a href="https://doi.org/10.1063/1.3250347">10.1063/1.3250347</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_8"></a>Macke, W. 1950. “Über Die Wechselwirkungen Im Fermi-Gas, Polarisationserscheinungen, Correlationsenergie, Elektronenkondensation.” <i>Z. Naturforsch.</i> 5a (8): 192–208. <a href="http://zfn.mpdl.mpg.de/data/Reihe_A/5/ZNA-1950-5a-0192.pdf">http://zfn.mpdl.mpg.de/data/Reihe_A/5/ZNA-1950-5a-0192.pdf</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_9"></a>Pines, David, and David Bohm. 1952. “A Collective Description of Electron Interactions: II. Collective Vs Individual Particle Aspects of the Interactions.” <i>Phys. Rev.</i> 85 (2): 338–53. doi:<a href="https://doi.org/10.1103/PhysRev.85.338">10.1103/PhysRev.85.338</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_10"></a>Shavitt, Isaiah, and Rodney J Bartlett. 2009. <i>Many-Body Methods in Chemistry and Physics: MBPT and Coupled-Cluster Theory</i>. Cambridge; New York: Cambridge University Press.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_11"></a>Čížek, Jirí. 1969. “On the Use of the Cluster Expansion and the Technique of Diagrams in Calculations of Correlation Effects in Atoms and Molecules.” In <i>Advances in Chemical Physics</i>, edited by R. LeFebvre and C. Moser, 35–89. John Wiley &#38; Sons, Inc.</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2022-07-06 Wed 11:46</p>
</div>
</body>
</html>
