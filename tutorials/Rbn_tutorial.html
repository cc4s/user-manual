<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-02-07 Mon 09:24 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>How to run <code>Cc4s</code> calculations?</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>

    <meta charset='UTF-8'>
    <meta name='apple-mobile-web-app-capable' content='yes'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.slim.min.js"
      integrity="sha512-6ORWJX/LrnSjBzwefdNUyLCMTIsGoNP6NftMy2UAm1JBm6PRZCO1d7OHBStWpVFZLO+RerTvqX/Z9mBFfCJZ4A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"></script>
    <link
      href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css'
      rel='stylesheet'
      integrity='sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU'
      crossorigin='anonymous'>
    <script
      src='https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js'
      integrity='sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ'
      crossorigin='anonymous'></script>

    <link rel="stylesheet" type="text/css" href="/user-manual/data/css/htmlize.css"/>
    <link rel="stylesheet" type="text/css" href="/user-manual/data/css/readtheorg.css"/>
    <link rel="stylesheet" type="text/css" href="/user-manual/data/css/rtd-full.css"/>

    <script type="text/javascript" src="/user-manual/data/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="preamble" class="status">

 <nav id="cc4s-navbar" class='navbar fixed-top navbar-expand-md navbar-light bg-light'>
   <div class='container-fluid'>
     <a class='navbar-brand' href='#'>
       Cc4s
     </a>
     <button class='navbar-toggler' type='button'
             data-bs-toggle='collapse'
             data-bs-target='#navbarSupportedContent'
             aria-controls='navbarSupportedContent'
             aria-expanded='false'
             aria-label='Toggle navigation'>
       <span class='navbar-toggler-icon'></span>
     </button>
     <div class='collapse navbar-collapse' id='navbarSupportedContent'>
       <ul class='navbar-nav me-auto mb-2 mb-lg-0'>
         <li class='nav-item'>
           <a class='nav-link' aria-current='page' href='/user-manual/index.html'>
             <i class='fa fa-home'></i>
             Home
           </a>
         </li>
         <li class='nav-item'>
           <a class='nav-link' href='/user-manual/sitemap.html'>
             <i class='fa fa-sign-out'></i>
             Sitemap
           </a>
         </li>
         <li class='nav-item'>
           <a class='nav-link' href='/user-manual/algorithms/sitemap.html'>
             <i class='fa fa-sign-out'></i>
             Algorithms
           </a>
         </li>
         <li class='nav-item'>
           <a class='nav-link' href='/user-manual/objects/sitemap.html'>
             <i class='fa fa-sign-out'></i>
             Objects
           </a>
         </li>
       </ul>
     </div>
   </div>
 </nav>
</div>
<div id="content">
<h1 class="title">How to run <code>Cc4s</code> calculations?</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org504fb32"><b>Step 1</b>: Coupled cluster singles and doubles theory calculations</a></li>
<li><a href="#orga0dcbcc"><b>Step 2</b>: Perturbative triples calculations</a></li>
<li><a href="#orgb11fe54"><b>Step 3</b>: Basis-set incompleteness error correction</a></li>
<li><a href="#org534597b"><b>Step 4</b>: Finite-size correction</a></li>
<li><a href="#org4ebd1c6"><b>Final energy</b></a></li>
</ul>
</div>
</div>
<p>
In this tutorial we explain all steps necessary to perform a  <code>Cc4s</code> calculation
on the level of CCSD(T) theory for a simple test system.
The test system corresponds to a periodic rhomobohedral boron nitride crystal.
All required <code>Cc4s</code> input files have been created using the <code>VASP</code> interface.
</p>

<p>
<code>Cc4s</code> calculations are controlled by a YAML input file, which is called <code>cc4s.in</code> in the present tutorial.
This input file consists of a list of calls to algorithms with input arguments and output objects.
Here, we will walk you through all employed algorithms used to compute the CCSD(T) correlation energy.
However, if you want to skip the detailed  explanations below and proceed directly to performing
CCSD(T) calculations, you might as well download the complete <code>cc4s.in</code> file <a href="../data/cc4s.in">here</a>.
</p>

<p>
The following files are needed to reproduce all calculations of this tutorial.
</p>

<ul class="org-ul">
<li>A working binary of <code>Cc4s</code> obtained by <a href="../gettingstarted/gettingstarted.html#ID-GettingStarted">compiling the code</a></li>
<li>A set of input files generated by the <code>VASP</code> <a href="../interfaces/vasp.html#ID-VaspInterface">interface</a> that can be downloaded (TODO add link here)
<ul class="org-ul">
<li><a href="../objects/EigenEnergies.html#ID-EigenEnergies">Eigenenergies</a> (\(\epsilon_{p}\)) : <code>EigenEnergies.yaml</code>, <code>EigenEnergies.elements</code></li>
<li><a href="../objects/CoulombVertex.html#ID-CoulombVertex">CoulombVertex</a> (\(\Gamma^{pG}_{q}\)) :  <code>CoulombVertex.yaml</code>, <code>CoulombVertex.elements</code></li>
<li><a href="../objects/GridVectors.html#ID-GridVectors">GridVectors</a> (\(\vec G\)) : <code>GridVectors.yaml</code>, <code>GridVectors.elements</code></li>
<li><a href="../objects/CoulombPotential.html#ID-CoulombPotential">CoulombPotential</a> (\(V(\vec G)\)) : <code>CoulombPotential.yaml</code>, <code>CoulombPotential.elements</code></li>
<li><a href="../objects/DeltaIntegrals.html#ID-DeltaIntegrals">DeltaIntegrals</a> (\(\delta^{ab}_{ij}\)) : <code>DeltaPPHH.yaml</code>, <code>DeltaPPHH.elements</code></li>
<li><a href="../objects/DeltaIntegrals.html#ID-DeltaIntegrals">DeltaIntegrals</a> (\(\delta_{ij}\)) : <code>DeltaHH.yaml</code>, <code>DeltaHH.elements</code></li>
<li><a href="../objects/CoulombVertexSingularVectors.html#ID-CoulombVertexSingularVectors">CoulombVertexSingularVetors</a> (\(U_{G}^{F}\)) : <code>CoulombVertexSingularVectors.yaml</code>, <code>CoulombVertexSingularVectors.elements</code></li>
<li><a href="../objects/Mp2PairEnergies.html#ID-Mp2PairEnergies">Mp2PairEnergies</a> (\(\epsilon_{ij}\)) : <code>Mp2PairEnergies.yaml</code>, <code>Mp2PairEnergies.elements</code></li>
</ul></li>
</ul>


<p>
For the following example we assume that all input files listed above and the <code>cc4s.in</code> file
are located in the same directory.
The <code>cc4s.in</code> YAML input file is described in the following section in detail.
</p>

<div id="outline-container-org504fb32" class="outline-2">
<h2 id="org504fb32"><a href="#org504fb32"><b>Step 1</b>: Coupled cluster singles and doubles theory calculations</a></h2>
<div class="outline-text-2" id="text-org504fb32">
<p>
We start this tutorial by taking the first steps in <code>Cc4s</code> needed to compute the CCSD correlation energy.
For this purpose essential data files have to be read from disk using the <code>Read</code> algorithm.
This aglorithm can be executed employing the following  <code>cc4s.in</code> YAML input which controls <code>Cc4s</code>
</p>

<div class="org-src-container">
<pre class="src src-yaml">- <span style="color: #8b4513;">name</span>: Read
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">fileName</span>: <span style="color: #50a14f;">"CoulombVertex.yaml"</span>
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">destination</span>: CoulombVertex
</pre>
</div>

<p>
The above call to the <a href="../algorithms/Read.html#ID-Read">Read</a> algorithm reads the
<b>CoulombVertex.yaml</b> file that contains all meta-information associated with the
<a href="../objects/CoulombVertex.html#ID-CoulombVertex"><code>CoulombVertex</code></a> tensor in a human-readable format.
<code>Cc4s</code> will read all numerical data belonging to
the corresponding <a href="../objects/CoulombVertex.html#ID-CoulombVertex"><code>CoulombVertex</code></a> tensor from the <b>CoulombVertex.elements</b> binary file stored on disk.
The output of <a href="../algorithms/Read.html#ID-Read">Read</a> algorithm is the <a href="../objects/CoulombVertex.html#ID-CoulombVertex"><code>CoulombVertex</code></a> tensor object, which can
be used as input for all subsequent <code>Cc4s</code> algorithms.
</p>

<p>
In addition, we use <code>Cc4s</code> to read the <b>EigenEnergies.yaml</b> and
<b>EigenEnergies.elements</b> files by including the following <a href="../algorithms/Read.html#ID-Read">Read</a> call in <code>cc4s.in</code>
</p>
<div class="org-src-container">
<pre class="src src-yaml">- <span style="color: #8b4513;">name</span>: Read
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">fileName</span>: <span style="color: #50a14f;">"EigenEnergies.yaml"</span>
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">destination</span>: EigenEnergies
</pre>
</div>

<p>
In the following step we include two further algorithm calls that are necessary
to process the <a href="../objects/CoulombVertex.html#ID-CoulombVertex"><code>CoulombVertex</code></a> and <a href="../objects/EigenEnergies.html#ID-EigenEnergies">EigenEnergies</a>
tensors in <code>Cc4s</code> and prepare them for coupled-cluster calculations. To this end the <code>cc4s.in</code> file calls the
<a href="../algorithms/DefineHolesAndParticles.html#ID-DefineHolesAndParticles">DefineHolesAndParticles</a> and
<a href="../algorithms/SliceOperator.html#ID-SliceOperator">SliceOperator</a> algorithms as described below
</p>

<div class="org-src-container">
<pre class="src src-yaml">- <span style="color: #8b4513;">name</span>: DefineHolesAndParticles
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">eigenEnergies</span>: EigenEnergies
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">slicedEigenEnergies</span>: EigenEnergies

- <span style="color: #8b4513;">name</span>: SliceOperator
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">slicedEigenEnergies</span>: EigenEnergies
    <span style="color: #8b4513;">operator</span>: CoulombVertex
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">slicedOperator</span>: CoulombVertex
</pre>
</div>

<p>
Note that the above algorithms overwrite the original tensors stored in
<a href="../objects/CoulombVertex.html#ID-CoulombVertex"><code>CoulombVertex</code></a> and <a href="../objects/EigenEnergies.html#ID-EigenEnergies">EigenEnergies</a>,
turning them into objects corresponding to sets of tensors with partitioned orbital indices, respectively.
In particular, all state indices have been partitioned to refer to particle or hole states; for example,
\(\epsilon_q \rightarrow \{\epsilon_a, \epsilon_i\}\).
Using these outputs, we call the <a href="../algorithms/VertexCoulombIntegrals.html#ID-VertexCoulombIntegrals">VertexCoulombIntegrals</a>
algorithm by including the following paragraph in the  <code>cc4s.in</code> file
</p>
<div class="org-src-container">
<pre class="src src-yaml">- <span style="color: #8b4513;">name</span>: VertexCoulombIntegrals
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">slicedCoulombVertex</span>: CoulombVertex
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">coulombIntegrals</span>: CoulombIntegrals
</pre>
</div>

<p>
The <a href="../algorithms/VertexCoulombIntegrals.html#ID-VertexCoulombIntegrals">VertexCoulombIntegrals</a> algorithm generates the <a href="../objects/CoulombIntegrals.html#ID-CoulombIntegrals">CoulombIntegrals</a> as output, which serve as input to the
<a href="../algorithms/CoupledCluster.html#ID-CoupledCluster">CoupledCluster</a> algorithm and is called using the following code block in  <code>cc4s.in</code>
</p>

<div class="org-src-container">
<pre class="src src-yaml">- <span style="color: #8b4513;">name</span>: CoupledCluster
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">method</span>: Ccsd
    <span style="color: #8b4513;">integralsSliceSize</span>: 100
    <span style="color: #8b4513;">slicedEigenEnergies</span>: EigenEnergies
    <span style="color: #8b4513;">coulombIntegrals</span>: CoulombIntegrals
    <span style="color: #8b4513;">slicedCoulombVertex</span>: CoulombVertex
    <span style="color: #8b4513;">maxIterations</span>: 30
    <span style="color: #8b4513;">energyConvergence</span>: 1.0E-5
    <span style="color: #8b4513;">amplitudesConvergence</span>: 1.0E-5
    <span style="color: #8b4513;">mixer</span>:
      <span style="color: #8b4513;">type</span>: DiisMixer
      <span style="color: #8b4513;">maxResidua</span>: 5
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">amplitudes</span>: Amplitudes
</pre>
</div>

<p>
If all code blocks given above are included in the <code>cc4s.in</code> file and all other prerequisites are fulfilled,
<code>Cc4s</code> can be called by typing the following command in the terminal:
</p>
<div class="org-src-container">
<pre class="src src-sh">mpirun -np 48 Cc4s -i cc4s.in
</pre>
</div>
<p>
In the present example we run the calculations in parallel using 48 compute cores.
</p>

<p>
If all algorithms work successfully, the following output stream will appear on the terminal
</p>
<div class="org-src-container">
<pre class="src src-sh">
                __ __      
     __________/ // / _____
    / ___/ ___/ // /_/ ___/
   / /__/ /__/__  __(__  ) 
   <span style="color: #50a14f;">\_</span>__/<span style="color: #50a14f;">\_</span>__/  /_/ /____/  
  Coupled Cluster for Solids

version: heads/develop-0-g5339629, date: Tue Feb 1 16:44:23 2022 +0100
build date: Feb  1 2022 17:42:37
compiler: icc (ICC) 19.1.0.166 20191121
total processes: 48
calculation started on: Mon Feb  7 09:46:22 2022


execution plan read, steps: 6

step: 1, Read
Reading from binary file CoulombVertex.elements
realtime 0.117790191 s
--
step: 2, Read
Reading from text file EigenEnergies.elements
realtime 0.003308821 s
--
step: 3, DefineHolesAndParticles
number of holes     No: 16
number of particles Nv: 80
number of states    Np: 96
realtime 0.001116923 s
--
step: 4, SliceOperator
Slicing CoulombVertex.elements into holes and particles.
realtime 0.002643576 s
--
step: 5, VertexCoulombIntegrals
Using real Coulomb integrals
number of field variables NF: 356
realtime 0.001467920 s
--
step: 6, CoupledCluster
Using method Ccsd. integralsSliceSize: 100
Using mixer DiisMixer. maxResidua: 5
Maximum number of iterations: 30
Unless reaching energy convergence dE: 1e-05
and amplitudes convergence dR: 1e-05
Iter         Energy         dE           dR         time   GF/s/core
   1  -2.43605043e+01  -2.4361e+01   4.3924e-01      0.1    4.2
   2  -2.47577534e+01  -3.9725e-01   7.4733e-02      0.8    4.9
   3  -2.53776918e+01  -6.1994e-01   1.8674e-02      0.7    5.5
   4  -2.54455925e+01  -6.7901e-02   6.4132e-03      0.7    5.5
   5  -2.54445080e+01   1.0845e-03   2.2120e-03      0.7    5.4
   6  -2.54458312e+01  -1.3232e-03   1.0304e-03      0.7    5.4
   7  -2.54448941e+01   9.3705e-04   5.0727e-04      0.7    5.4
   8  -2.54452894e+01  -3.9521e-04   1.9694e-04      0.7    5.4
   9  -2.54454262e+01  -1.3682e-04   7.7180e-05      0.7    5.4
  10  -2.54455328e+01  -1.0663e-04   3.0247e-05      0.7    5.5
  11  -2.54455929e+01  -6.0110e-05   1.1758e-05      0.7    5.4
  12  -2.54456151e+01  -2.2218e-05   5.0053e-06      0.7    5.5
  13  -2.54456249e+01  -9.7454e-06   2.2689e-06      0.7    5.4

Ccsd correlation energy:          -25.4456248862
2nd-order correlation energy:     -24.3605043096
realtime 8.742863556 s
--
total realtime: 8.873855540 s
total operations: 2267.4 GFLOPS, speed: 5.3 GFLOPS/s/core
</pre>
</div>

<p>
The CCSD correlation energy can either be extracted
directly from the standard output stream or the <code>cc4s.out.yaml</code> YAML file, which contains additional information as well
as the correlation energy. The corresponding block of <code>cc4s.out.yaml</code> reads
</p>
<div class="org-src-container">
<pre class="src src-yaml">    <span style="color: #8b4513;">name</span>: CoupledCluster
    <span style="color: #8b4513;">out</span>:
      <span style="color: #8b4513;">amplitudes</span>: 0x1ad98b8
      <span style="color: #8b4513;">convergenceReached</span>: 1
      <span style="color: #8b4513;">energy</span>:
        <span style="color: #8b4513;">correlation</span>: -25.445624886202758
        <span style="color: #8b4513;">direct</span>: -38.822491455744313
        <span style="color: #8b4513;">exchange</span>: 13.376866569541555
        <span style="color: #8b4513;">secondOrder</span>: -24.360504309639897
        <span style="color: #8b4513;">unit</span>: 0.036749322175638754
    <span style="color: #8b4513;">realtime</span>: 8.742863556
</pre>
</div>
<p>
Note that the energies are given in units of eV for the present system. The energy units are defined by
input files and always correspond to eV in the case of input files generated by <code>VASP</code>.
</p>
</div>
</div>

<div id="outline-container-orga0dcbcc" class="outline-2">
<h2 id="orga0dcbcc"><a href="#orga0dcbcc"><b>Step 2</b>: Perturbative triples calculations</a></h2>
<div class="outline-text-2" id="text-orga0dcbcc">
<p>
We now proceed with the CCSD(T) energy calculation and seek to compute the (T) contribution,
which has to be added to the CCSD correlation energy contribution estimated in the
previous section.
</p>

<p>
The <a href="../algorithms/PerturbativeTriples.html#ID-PerturbativeTriples">PerturbativeTriples</a> algorithm computes the (T)
correlation energy contribution and is called from the <code>cc4s.in</code> file in the following manner
</p>

<div class="org-src-container">
<pre class="src src-yaml">- <span style="color: #8b4513;">name</span>: PerturbativeTriples
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">slicedEigenEnergies</span>: EigenEnergies
    <span style="color: #8b4513;">amplitudes</span>: Amplitudes
    <span style="color: #8b4513;">coulombIntegrals</span>: CoulombIntegrals
  <span style="color: #8b4513;">out</span>:
    {}
</pre>
</div>

<p>
Note that the  <a href="../algorithms/PerturbativeTriples.html#ID-PerturbativeTriples">PerturbativeTriples</a> algorithm depends on <a href="../objects/Amplitudes.html#ID-Amplitudes">Amplitudes</a>
as input argument which has been computed above using the
<a href="../algorithms/CoupledCluster.html#ID-CoupledCluster">CoupledCluster</a> algorithm. 
If we append the above code block to the <code>cc4s.in</code> file described in the previous section and run <code>Cc4s</code>,
the following additional standard output stream should appear.
</p>
<div class="org-src-container">
<pre class="src src-sh">step: 7, PerturbativeTriples
<span style="color: #0184bc;">Progress</span>(%)  <span style="color: #a626a4;">time</span>(s)   GFLOP/s      
1            0         4.269        
10           0         5.763        
20           0         5.887        
30           0         6.017        
40           0         6.018        
50           0         6.034        
60           0         6.035        
70           0         6.029        
80           0         6.004        
90           0         6.011        
100          0         5.986        
(T) correlation energy:      -0.822530510989498
realtime 2.547204125 s
--
</pre>
</div>

<p>
The (T) correlation energy contribution can either be extracted
directly from the standard output stream or the <code>cc4s.out.yaml</code> YAML file, which contains additional information as well
as the correlation energy contribution. The corresponding block of <code>cc4s.out.yaml</code> reads
</p>
<div class="org-src-container">
<pre class="src src-yaml">    <span style="color: #8b4513;">name</span>: PerturbativeTriples
    <span style="color: #8b4513;">out</span>:
      <span style="color: #8b4513;">energy</span>:
        <span style="color: #8b4513;">correlation</span>: -0.82253051098949848
        <span style="color: #8b4513;">unit</span>: 0.036749322175638782
    <span style="color: #8b4513;">realtime</span>: 2.547204125
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb11fe54" class="outline-2">
<h2 id="orgb11fe54"><a href="#orgb11fe54"><b>Step 3</b>: Basis-set incompleteness error correction</a></h2>
<div class="outline-text-2" id="text-orgb11fe54">
<p>
We note that in the present case, the CCSD correlation energy is computed using a set of truncated
approximate natural orbitals. Increasing this basis set size yields correlation energies that
converge only slowly to the complete basis set limit. <code>Cc4s</code> includes an algorithm that can compute
a basis-set incompleteness error (BSIE) correction, yielding significantly more rapidly convergent correlation
energies with respect to the number virtual orbitals.
</p>

<p>
The <a href="../algorithms/BasisSetCorrection.html#ID-BasisSetCorrection">BasisSetCorrection</a> computes a BSIE correction for
CCSD theory and requires a set of additional input files that are also provided using the <code>VASP</code> interface.
Reading the corresponding input files and calling the
<a href="../algorithms/BasisSetCorrection.html#ID-BasisSetCorrection">BasisSetCorrection</a> algorithm is achieved using the
following code block in <code>cc4s.in</code>
</p>
<div class="org-src-container">
<pre class="src src-yaml">- <span style="color: #8b4513;">name</span>: Read
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">fileName</span>: <span style="color: #50a14f;">"DeltaIntegralsHH.yaml"</span>
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">destination</span>: Nij

- <span style="color: #8b4513;">name</span>: Read
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">fileName</span>: <span style="color: #50a14f;">"DeltaIntegralsPPHH.yaml"</span>
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">destination</span>: DeltaIntegrals

- <span style="color: #8b4513;">name</span>: Read
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">fileName</span>: <span style="color: #50a14f;">"Mp2PairEnergies.yaml"</span>
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">destination</span>: Mp2PairEnergies

- <span style="color: #8b4513;">name</span>: BasisSetCorrection
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">slicedEigenEnergies</span>: EigenEnergies
    <span style="color: #8b4513;">amplitudes</span>: Amplitudes
    <span style="color: #8b4513;">coulombIntegrals</span>: CoulombIntegrals
    <span style="color: #8b4513;">mp2PairEnergies</span>: Mp2PairEnergies
    <span style="color: #8b4513;">deltaIntegralsHH</span>: Nij
    <span style="color: #8b4513;">deltaIntegralsPPHH</span>: DeltaIntegrals
  <span style="color: #8b4513;">out</span>:
    {}
</pre>
</div>

<p>
Appending the code block above to the <code>cc4s.in</code> file described in all previous sections and running <code>Cc4s</code>,
yields the following additional standard output stream.
</p>
<div class="org-src-container">
<pre class="src src-sh">step: 8, Read
Reading from binary file DeltaIntegralsHH.elements
realtime 0.008716583 s
--
step: 9, Read
Reading from binary file DeltaIntegralsPPHH.elements
realtime 0.034012456 s
--
step: 10, Read
Reading from text file Mp2PairEnergies.elements
realtime 0.002247945 s
--
step: 11, BasisSetCorrection
Ccsd-Bsie energy correction:      -5.2998024502
realtime 0.079391342 s
--
</pre>
</div>

<p>
The BSIE correction can either be extracted
directly from the standard output stream or the <code>cc4s.out.yaml</code> file, which contains additional information as well
as the correction. The corresponding block of <code>cc4s.out.yaml</code> reads
</p>
<div class="org-src-container">
<pre class="src src-yaml">    <span style="color: #8b4513;">name</span>: BasisSetCorrection
    <span style="color: #8b4513;">out</span>:
      <span style="color: #8b4513;">energy</span>:
        <span style="color: #8b4513;">correction</span>: -5.2998024502064709
        <span style="color: #8b4513;">pplCorrection</span>: 1.2013851788124801
        <span style="color: #8b4513;">secondOrderCorrection</span>: -6.5011876290189505
        <span style="color: #8b4513;">uncorrectedCorrelation</span>: -25.445624886202786
        <span style="color: #8b4513;">unit</span>: 0.036749322175638782
    <span style="color: #8b4513;">realtime</span>: 0.079391342
</pre>
</div>
</div>
</div>

<div id="outline-container-org534597b" class="outline-2">
<h2 id="org534597b"><a href="#org534597b"><b>Step 4</b>: Finite-size correction</a></h2>
<div class="outline-text-2" id="text-org534597b">
<p>
In the present example the CCSD correlation energy is computed for a finite periodic simulation cell.
Increasing the size of the employed periodic simulation cell
yields correlation energies per atom that converge only slowly to the thermodynamic limit.
<code>Cc4s</code> includes an algorithm that can compute
a finite-size error correction, yielding significantly more rapidly convergent correlation
energies per atom with respect to the simulation cell size.
</p>

<p>
The <a href="../algorithms/FiniteSizeCorrection.html#ID-FiniteSizeCorrection">FiniteSizeCorrection</a> algorithm computes
a finite-size correction for CCSD theory and requires a set of additional input files that are also
provided by the <code>VASP</code> interface.
Reading the corresponding input files and calling the
<a href="../algorithms/FiniteSizeCorrection.html#ID-FiniteSizeCorrection">FiniteSizeCorrection</a>
algorithm is achieved using the following code block in <code>cc4s.in</code>
</p>
<div class="org-src-container">
<pre class="src src-yaml">- <span style="color: #8b4513;">name</span>: Read
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">fileName</span>: <span style="color: #50a14f;">"CoulombVertexSingularVectors.yaml"</span>
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">destination</span>: CoulombVertexSingularVectors

- <span style="color: #8b4513;">name</span>: Read
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">fileName</span>: <span style="color: #50a14f;">"GridVectors.yaml"</span>
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">destination</span>: GridVectors

- <span style="color: #8b4513;">name</span>: Read
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">fileName</span>: <span style="color: #50a14f;">"CoulombPotential.yaml"</span>
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">destination</span>: CoulombPotential

- <span style="color: #8b4513;">name</span>: FiniteSizeCorrection
  <span style="color: #8b4513;">in</span>:
    <span style="color: #8b4513;">slicedCoulombVertex</span>: CoulombVertex
    <span style="color: #8b4513;">amplitudes</span>: Amplitudes
    <span style="color: #8b4513;">coulombVertexSingularVectors</span>: CoulombVertexSingularVectors
    <span style="color: #8b4513;">coulombPotential</span>: CoulombPotential
    <span style="color: #8b4513;">gridVectors</span>: GridVectors
  <span style="color: #8b4513;">out</span>:
    <span style="color: #8b4513;">corrected</span>: Corrected
    <span style="color: #8b4513;">uncorrected</span>: Uncorrected
    <span style="color: #8b4513;">transitionStructureFactor</span>: SF
</pre>
</div>

<p>
Appending the code block above to the <code>cc4s.in</code> file described in all previous sections and running <code>Cc4s</code>,
yields the following additional standard output stream.
</p>
<div class="org-src-container">
<pre class="src src-sh">step: 12, Read
Reading from binary file CoulombVertexSingularVectors.elements
realtime 0.015900868 s
--
step: 13, Read
Reading from text file GridVectors.elements
realtime 0.003182427 s
--
step: 14, Read
Reading from text file CoulombPotential.elements
realtime 0.002309552 s
--
step: 15, FiniteSizeCorrection
Finite-size energy correction:    -1.1152868081
realtime 0.363875546 s
--
</pre>
</div>

<p>
The finite-size correction can either be extracted
directly from the standard output stream or the <code>cc4s.out.yaml</code> file, which contains additional information as well
as the correction. The corresponding block of <code>cc4s.out.yaml</code> reads
</p>
<div class="org-src-container">
<pre class="src src-yaml">    <span style="color: #8b4513;">name</span>: FiniteSizeCorrection
    <span style="color: #8b4513;">out</span>:
      <span style="color: #8b4513;">energy</span>:
        <span style="color: #8b4513;">corrected</span>: -26.560663044130632
        <span style="color: #8b4513;">correction</span>: -1.1152868080903175
        <span style="color: #8b4513;">uncorrected</span>: -25.445376236040314
        <span style="color: #8b4513;">unit</span>: 0.03674932217686841
      <span style="color: #8b4513;">transitionStructureFactor</span>: 0x2cb2f18
    <span style="color: #8b4513;">realtime</span>: 0.363875546
</pre>
</div>
</div>
</div>

<div id="outline-container-org4ebd1c6" class="outline-2">
<h2 id="org4ebd1c6"><a href="#org4ebd1c6"><b>Final energy</b></a></h2>
<div class="outline-text-2" id="text-org4ebd1c6">
<p>
We now discuss how to combine all energy contributions from above to obtain the final estimate of the
ground state energy in the thermodynamic and complete basis-set limit.
The table below summarizes all computed ground state energy contributions for the present example.
</p>

<table id="orga7159c3" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Ground state energy summary for present example. All energies in eV.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Contribution</th>
<th scope="col" class="org-right">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Hartree&#x2013;Fock</td>
<td class="org-right">-116.426066</td>
</tr>

<tr>
<td class="org-left">CCSD correlation</td>
<td class="org-right">-25.445625</td>
</tr>

<tr>
<td class="org-left">(T)  correlation</td>
<td class="org-right">-0.822531</td>
</tr>

<tr>
<td class="org-left">CCSD BSIE energy correction</td>
<td class="org-right">-5.299802</td>
</tr>

<tr>
<td class="org-left">CCSD finite-size energy correction</td>
<td class="org-right">-1.115287</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>CCSD(T) energy + corrections</code></td>
<td class="org-right">-149.109311</td>
</tr>
</tbody>
</table>

<p>
Please note that the Hartree&#x2013;Fock energy contribution was obtained using a preceeding <code>VASP</code> calculation. We recommend to
converge the Hartree&#x2013;Fock energy contribution to the thermodynamic limit separately using denser \(k\) -meshes.
The final <code>CCSD(T) energy + corrections</code> value can be used to study all accessible physical properties of interest.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2022-02-07 Mon 09:24</p>
</div>
</body>
</html>
